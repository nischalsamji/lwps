# Introduction #

The Light-Weight Publish Subscribe (lwps) library is a set of classes providing asynchronous publish subscribe mechanism to client applications. The library arose from a need to provide a simple abstraction for the publish-subscribe messaging model. The library is written in Java and provides some useful features such as multiple sessions, specifying arbitrary properties for each session and sending multi-line messages. In addition, a user can setup an HTTP proxy (implemented as servlets) to send and receive messages over HTTP. The proxy is implemented as a set of J2EE servlets and needs a container such as Tomcat or JBoss to use this method. A port of the library for mobile phones (J2ME) has also been implemented. This allows the library to be used on J2ME clients. As in the normal version, the mobile port can either connect directly or via the HTTP proxy.

# Details #
The following figure shows a class overview of the lwps library. It illustrates the core classes and how they are organized.

![http://code.lwps.googlepages.com/lwps_class_diagram.png](http://code.lwps.googlepages.com/lwps_class_diagram.png)

The function of each set of classes is now briefly described.

Setup classes (includes `Setup` and `HttpSetup`): Used to initialize and set up a new event. The sole static method `setup()` takes in a `String` code and a `Properties` object as arguments. The code is used by the server to create and name a connection context. Once a connection has been setup, publishers and subscribers can connect to the server by providing the code used to name a context. The properties are a set of key-value pairs and sent to each subscriber connecting to the server. This behavior can be used to pass application-specific initialization parameters to the subscribers.

Publisher classes (includes the interface `IPublisher` and implementations `Publisher` and `HttpPublisher`): Used by client applications to send messages to subscribers. The method `connect()` takes in a `String` code and a `Properties` object as arguments. The properties are a set of key-value pairs and sent to each subscriber connecting to the server. This behavior can be used to pass publisher-specific parameters to the subscribers. The `sendMessage()` method is used by clients to publish a message on the server from where it is broadcast to all subscribers.

Subscriber classes (includes the interface `ISubscriber` and implementations `Subscriber` and `HttpSubscriber`): Used by client applications to receive messages from publishers. The method connect() takes in a String code and a Properties object as arguments. The properties are a set of key-value pairs and stored (but currently, not otherwise used) on the server. The next 3 methods: `setup()`, `newPublisher()` and `receiveMessage()` are callbacks used by the implementation classes to inform client application about application-specific initialization parameters, publisher-specific parameters and message received respectively. The default implementation is empty for these methods. A client application may therefore override the methods to respond to these events.

`LWPSServer` is the class which implements a server using plain sockets. The server communicates using a custom protocol. When a new event is setup, the server creates a `ConnectionContext` entry in the `connMap` map with the event code as key. When a publisher or subscriber connects to the server and provides the event code, it is added to the corresponding connection context. Thus, the server can host multiple events (each with its own set of publishers and subscribers) simultaneously.